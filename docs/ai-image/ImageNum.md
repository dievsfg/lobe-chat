# 图片数量选择器组件 PRD

## 1. 产品概述

### 1.1 组件名称

ImageCountSelector - 图片数量选择器

### 1.2 功能描述

一个用于AI绘画工具的图片数量选择组件，支持快速选择预设数量和自定义输入数量，采用内联编辑的交互方式。

### 1.3 使用场景

- AI图像生成工具的配置面板
- 批量处理工具的数量设置
- 需要在预设值和自定义值之间快速切换的场景

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 预设数量选择

- **功能**：提供4个预设按钮，数值为 `1, 2, 4, 8`
- **交互**：点击按钮直接选择对应数量
- **状态**：选中的按钮高亮显示（白色背景+黑色文字）

#### 2.1.2 自定义数量输入

- **触发**：点击最右侧的"+"按钮或自定义数值按钮
- **交互**：整行按钮切换为输入框模式
- **输入范围**：1-50的整数
- **确认方式**：

- 点击绿色确认按钮（✓图标）
- 按下回车键

- **取消方式**：

- 点击取消按钮（×图标）
- 按下ESC键

#### 2.1.3 状态显示

- **预设状态**：对应预设按钮高亮
- **自定义状态**：最右侧按钮显示具体数值并高亮

### 2.2 交互流程

```plaintext
正常模式 → 点击预设按钮 → 直接选择数量
         ↓
         点击+按钮/自定义按钮
         ↓
编辑模式 → 输入数量 → 确认(Enter/✓) → 返回正常模式
         ↓           ↓
         ↓           取消(ESC/×) → 返回正常模式
         ↓
         自动聚焦并全选输入框内容
```

## 3. 技术规格

### 3.1 组件接口

```typescript
interface ImageCountSelectorProps {
  value?: number; // 当前选择的数量，默认1
  onChange?: (count: number) => void; // 数量变化回调
  presetCounts?: number[]; // 预设数量选项，默认[1,2,4,8]
  min?: number; // 最小值，默认1
  max?: number; // 最大值，默认50
  disabled?: boolean; // 是否禁用
}
```

### 3.2 状态管理

```typescript
// 内部状态
const [imageCount, setImageCount] = useState<number>(1);
const [isEditing, setIsEditing] = useState<boolean>(false);
const [customCount, setCustomCount] = useState<string>('');
```

### 3.3 关键方法

- `handlePresetClick(count: number)` - 处理预设按钮点击
- `handleEditStart()` - 进入编辑模式
- `handleCustomConfirm()` - 确认自定义输入
- `handleCustomCancel()` - 取消自定义输入
- `handleKeyPress(e: KeyboardEvent)` - 处理键盘事件

## 4. 视觉设计

### 4.1 主题适配

- **背景色**：深色主题 `bg-black`
- **文字色**：白色 `text-white`

### 4.2 按钮样式

#### 正常状态

- 背景：`bg-zinc-800`
- 边框：`border-zinc-700`
- 文字：`text-white`
- 悬停：`hover:bg-zinc-700`

#### 选中状态

- 背景：`bg-white`
- 文字：`text-black`
- 悬停：`hover:bg-gray-200`

### 4.3 输入框样式

- 背景：`bg-zinc-800`
- 边框：`border-zinc-700`
- 文字：`text-white`
- 占位符：`placeholder:text-zinc-500`

### 4.4 操作按钮

- **确认按钮**：绿色 `bg-green-600` + 对勾图标
- **取消按钮**：灰色边框 `border-zinc-600` + 叉号图标

## 5. 用户体验要求

### 5.1 响应性

- 按钮点击立即响应
- 状态切换流畅无延迟
- 输入验证实时反馈

### 5.2 易用性

- 进入编辑模式时自动聚焦输入框
- 自动全选当前数值便于修改
- 支持键盘快捷操作（回车确认、ESC取消）

### 5.3 反馈机制

- 无效输入时禁用确认按钮
- 清晰的视觉状态区分
- 平滑的模式切换动画

## 6. 边界条件

### 6.1 输入验证

- 只接受1-50范围内的整数
- 空值或无效值时禁用确认
- 超出范围时显示错误状态

### 6.2 异常处理

- 输入非数字字符时自动过滤
- 网络异常时保持本地状态
- 组件卸载时清理事件监听

## 7. 测试用例

### 7.1 功能测试

- 点击预设按钮能正确选择数量
- 点击+按钮能进入编辑模式
- 输入有效数字能成功确认
- 回车键能确认输入
- ESC键能取消输入
- 输入无效数字时确认按钮被禁用

### 7.2 界面测试

- 选中状态视觉反馈正确
- 编辑模式切换流畅
- 深色主题样式正确
- 响应式布局适配

### 7.3 边界测试

- 输入1和50边界值正常
- 输入0和51时被拒绝
- 输入非数字字符被过滤
- 空输入时确认按钮禁用

## 8. 实现优先级

### P0 (必须实现)

- 预设按钮选择功能
- 内联编辑模式
- 基础输入验证
- 键盘快捷键支持

### P1 (重要功能)

- 视觉状态反馈
- 自动聚焦和全选
- 深色主题适配

### P2 (优化功能)

- 切换动画效果
- 更丰富的错误提示
- 可配置的预设选项
